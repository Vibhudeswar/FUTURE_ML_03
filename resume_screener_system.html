<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ResumeIQ â€” AI Resume Screening System</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet"/>
<style>
  :root {
    --bg: #07080d;
    --surface: #0f1118;
    --card: #13161f;
    --border: #1e2130;
    --border2: #252840;
    --green: #00e5a0;
    --green-dim: #00e5a022;
    --yellow: #fbbf24;
    --yellow-dim: #fbbf2422;
    --red: #ff4d6d;
    --red-dim: #ff4d6d22;
    --blue: #4f8eff;
    --blue-dim: #4f8eff18;
    --purple: #9b59ff;
    --purple-dim: #9b59ff18;
    --cyan: #00d4ff;
    --text: #e8ecf4;
    --sub: #6b7394;
    --sub2: #3d4260;
    --accent: #00e5a0;
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€ noise overlay â”€â”€ */
  body::before {
    content:'';
    position:fixed; inset:0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events:none; z-index:0; opacity:.6;
  }

  /* â”€â”€ grid lines bg â”€â”€ */
  body::after {
    content:'';
    position:fixed; inset:0;
    background-image:
      linear-gradient(var(--border) 1px, transparent 1px),
      linear-gradient(90deg, var(--border) 1px, transparent 1px);
    background-size: 60px 60px;
    opacity:.3; pointer-events:none; z-index:0;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  header {
    position: relative; z-index:10;
    padding: 28px 48px;
    display: flex; align-items: center; justify-content: space-between;
    border-bottom: 1px solid var(--border);
    backdrop-filter: blur(12px);
    background: rgba(7,8,13,.7);
  }
  .logo {
    font-family:'Syne',sans-serif; font-weight:800; font-size:22px;
    display:flex; align-items:center; gap:10px; letter-spacing:-.5px;
  }
  .logo-dot {
    width:10px; height:10px; background:var(--green);
    border-radius:50%; box-shadow:0 0 12px var(--green); animation:pulse 2s infinite;
  }
  @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(1.3)} }

  .header-badge {
    font-family:'DM Mono',monospace; font-size:11px; color:var(--sub);
    border:1px solid var(--border2); padding:6px 14px; border-radius:20px;
    letter-spacing:.08em;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .hero {
    position:relative; z-index:5;
    padding: 80px 48px 60px;
    max-width: 900px;
  }
  .hero-tag {
    font-family:'DM Mono',monospace; font-size:11px; color:var(--green);
    letter-spacing:.2em; text-transform:uppercase;
    display:flex; align-items:center; gap:8px; margin-bottom:20px;
  }
  .hero-tag::before { content:''; width:24px; height:1px; background:var(--green); }
  h1 {
    font-family:'Syne',sans-serif; font-size:clamp(38px,6vw,68px);
    font-weight:800; line-height:1.0; letter-spacing:-2px;
    margin-bottom:20px;
  }
  h1 em { font-style:normal; color:var(--green); }
  .hero-sub {
    font-size:16px; color:var(--sub); line-height:1.6; max-width:560px;
    font-weight:300;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .main { position:relative; z-index:5; padding: 0 48px 80px; max-width:1400px; margin:0 auto; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STEP CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .step-row {
    display:grid; grid-template-columns:repeat(3,1fr); gap:1px;
    background:var(--border); border:1px solid var(--border);
    border-radius:16px; overflow:hidden; margin-bottom:40px;
  }
  .step-card {
    background:var(--card); padding:28px 24px;
    display:flex; flex-direction:column; gap:8px;
  }
  .step-num {
    font-family:'DM Mono',monospace; font-size:10px; color:var(--sub);
    letter-spacing:.15em; margin-bottom:4px;
  }
  .step-title { font-family:'Syne',sans-serif; font-weight:700; font-size:15px; }
  .step-desc { font-size:12px; color:var(--sub); line-height:1.5; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .panel {
    background:var(--card); border:1px solid var(--border);
    border-radius:16px; overflow:hidden; margin-bottom:24px;
  }
  .panel-header {
    padding:20px 28px; border-bottom:1px solid var(--border);
    display:flex; align-items:center; gap:12px;
  }
  .panel-icon { font-size:18px; }
  .panel-title { font-family:'Syne',sans-serif; font-weight:700; font-size:15px; }
  .panel-body { padding:28px; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ UPLOAD ZONE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .upload-zone {
    border:2px dashed var(--border2); border-radius:12px;
    padding:48px; text-align:center; cursor:pointer;
    transition:all .25s; position:relative; overflow:hidden;
    background:var(--surface);
  }
  .upload-zone:hover, .upload-zone.drag { border-color:var(--green); background:var(--green-dim); }
  .upload-zone.drag { transform:scale(1.01); }
  .upload-icon { font-size:40px; margin-bottom:16px; display:block; }
  .upload-title { font-family:'Syne',sans-serif; font-weight:700; font-size:17px; margin-bottom:8px; }
  .upload-sub { font-size:13px; color:var(--sub); }
  .upload-zone input { position:absolute; inset:0; opacity:0; cursor:pointer; }
  .upload-formats {
    display:flex; gap:8px; justify-content:center; margin-top:16px; flex-wrap:wrap;
  }
  .fmt-badge {
    font-family:'DM Mono',monospace; font-size:10px;
    border:1px solid var(--border2); border-radius:4px;
    padding:3px 8px; color:var(--sub); letter-spacing:.05em;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ JOB ROLE SELECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .role-grid {
    display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-bottom:0;
  }
  .role-btn {
    background:var(--surface); border:1px solid var(--border2);
    border-radius:10px; padding:14px 12px; cursor:pointer;
    font-family:'DM Sans',sans-serif; font-size:13px; color:var(--sub);
    text-align:left; transition:all .2s; display:flex; flex-direction:column; gap:4px;
  }
  .role-btn:hover { border-color:var(--blue); color:var(--text); background:var(--blue-dim); }
  .role-btn.active { border-color:var(--green); color:var(--green); background:var(--green-dim); }
  .role-btn .role-icon { font-size:18px; }
  .role-btn .role-name { font-family:'Syne',sans-serif; font-weight:700; font-size:13px; }
  .role-btn .role-skills { font-size:11px; color:var(--sub); font-family:'DM Mono',monospace; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ANALYZE BTN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .analyze-btn {
    width:100%; padding:18px; border:none; border-radius:12px;
    background:var(--green); color:#07080d;
    font-family:'Syne',sans-serif; font-weight:800; font-size:16px;
    cursor:pointer; letter-spacing:.02em; transition:all .2s;
    display:flex; align-items:center; justify-content:center; gap:10px;
    margin-top:20px;
  }
  .analyze-btn:hover { transform:translateY(-2px); box-shadow:0 12px 40px rgba(0,229,160,.3); }
  .analyze-btn:disabled { opacity:.4; cursor:not-allowed; transform:none; }
  .analyze-btn .btn-spinner { animation:spin .8s linear infinite; display:none; }
  .analyze-btn.loading .btn-spinner { display:inline-block; }
  .analyze-btn.loading .btn-text { display:none; }
  @keyframes spin { to{transform:rotate(360deg)} }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ FILE LIST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .file-list { display:flex; flex-direction:column; gap:8px; margin-top:16px; }
  .file-item {
    display:flex; align-items:center; gap:12px;
    background:var(--surface); border:1px solid var(--border2);
    border-radius:8px; padding:10px 14px;
  }
  .file-item .file-icon { font-size:16px; }
  .file-item .file-name { font-size:13px; flex:1; font-family:'DM Mono',monospace; }
  .file-item .file-size { font-size:11px; color:var(--sub); }
  .file-item .file-remove {
    background:none; border:none; color:var(--sub); cursor:pointer;
    font-size:16px; transition:color .2s;
  }
  .file-item .file-remove:hover { color:var(--red); }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .progress-wrap { margin-top:20px; display:none; }
  .progress-wrap.show { display:block; }
  .progress-label { font-family:'DM Mono',monospace; font-size:11px; color:var(--sub); margin-bottom:8px; }
  .progress-bar { height:3px; background:var(--border); border-radius:2px; overflow:hidden; }
  .progress-fill { height:100%; background:var(--green); width:0%; transition:width .4s; border-radius:2px; }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RESULTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #results { display:none; }
  #results.show { display:block; }

  /* score badge */
  .score-badge {
    display:inline-flex; align-items:center; gap:6px;
    padding:4px 12px; border-radius:20px; font-size:12px; font-weight:600;
    font-family:'DM Mono',monospace;
  }
  .score-badge.rec { background:var(--green-dim); color:var(--green); border:1px solid var(--green); }
  .score-badge.pot { background:var(--yellow-dim); color:var(--yellow); border:1px solid var(--yellow); }
  .score-badge.no  { background:var(--red-dim); color:var(--red); border:1px solid var(--red); }

  /* â”€â”€ summary cards row â”€â”€ */
  .summary-row { display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin-bottom:24px; }
  .summary-card {
    background:var(--card); border:1px solid var(--border);
    border-radius:12px; padding:20px 18px;
  }
  .summary-card .sc-val {
    font-family:'Syne',sans-serif; font-weight:800; font-size:32px; line-height:1;
    margin-bottom:4px;
  }
  .summary-card .sc-label { font-size:12px; color:var(--sub); font-family:'DM Mono',monospace; }

  /* â”€â”€ candidate cards â”€â”€ */
  .candidates-grid { display:flex; flex-direction:column; gap:12px; }
  .cand-card {
    background:var(--surface); border:1px solid var(--border2);
    border-radius:12px; padding:20px 24px;
    display:grid; grid-template-columns:40px 1fr auto;
    gap:16px; align-items:start; cursor:pointer;
    transition:all .2s;
  }
  .cand-card:hover { border-color:var(--border2); transform:translateX(4px); }
  .cand-card.expanded { background:var(--card); border-color:var(--green); }
  .cand-rank {
    width:40px; height:40px; border-radius:10px;
    background:var(--card); border:1px solid var(--border2);
    display:flex; align-items:center; justify-content:center;
    font-family:'DM Mono',monospace; font-size:13px; font-weight:500; color:var(--sub);
    flex-shrink:0;
  }
  .cand-rank.gold { background:rgba(251,191,36,.1); border-color:var(--yellow); color:var(--yellow); }
  .cand-rank.silver { background:rgba(148,163,184,.1); border-color:#94a3b8; color:#94a3b8; }
  .cand-rank.bronze { background:rgba(180,120,60,.1); border-color:#b47a3c; color:#b47a3c; }

  .cand-info .cand-cat { font-family:'Syne',sans-serif; font-weight:700; font-size:15px; margin-bottom:6px; }
  .cand-info .cand-meta { font-size:12px; color:var(--sub); font-family:'DM Mono',monospace; }

  /* score bar */
  .score-bar-wrap { margin-top:10px; }
  .score-bar-track { height:4px; background:var(--border); border-radius:2px; overflow:hidden; margin-top:4px; }
  .score-bar-fill { height:100%; border-radius:2px; transition:width 1s cubic-bezier(.4,0,.2,1); }

  /* factor bars */
  .factors-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:14px; }
  .factor-row { display:flex; flex-direction:column; gap:4px; }
  .factor-label { font-size:11px; color:var(--sub); font-family:'DM Mono',monospace; display:flex; justify-content:space-between; }
  .factor-track { height:3px; background:var(--border); border-radius:2px; overflow:hidden; }
  .factor-fill { height:100%; border-radius:2px; background:var(--blue); }

  /* skills chips */
  .skills-section { margin-top:14px; display:none; }
  .cand-card.expanded .skills-section { display:block; }
  .skills-label { font-size:11px; color:var(--sub); font-family:'DM Mono',monospace; margin-bottom:6px; }
  .skills-chips { display:flex; flex-wrap:wrap; gap:5px; }
  .chip {
    font-size:11px; padding:3px 9px; border-radius:4px;
    font-family:'DM Mono',monospace; letter-spacing:.02em;
  }
  .chip.matched { background:var(--green-dim); color:var(--green); border:1px solid rgba(0,229,160,.25); }
  .chip.missing { background:var(--red-dim); color:var(--red); border:1px solid rgba(255,77,109,.25); }
  .chip.bonus   { background:var(--blue-dim); color:var(--blue); border:1px solid rgba(79,142,255,.25); }

  /* â”€â”€ heatmap â”€â”€ */
  .heatmap-wrap { overflow-x:auto; }
  .heatmap-table { border-collapse:collapse; width:100%; min-width:600px; font-size:11px; }
  .heatmap-table th {
    padding:6px 4px; font-family:'DM Mono',monospace; font-weight:400;
    color:var(--sub); text-align:center; font-size:10px;
    border-bottom:1px solid var(--border); writing-mode:vertical-rl;
    transform:rotate(180deg); white-space:nowrap; height:80px; vertical-align:bottom;
  }
  .heatmap-table th.row-head { writing-mode:horizontal-tb; transform:none; height:auto; text-align:right; padding-right:10px; white-space:nowrap; }
  .heatmap-table td { padding:5px 4px; text-align:center; border:1px solid var(--border); font-size:13px; }
  .heatmap-table td.row-label { text-align:right; padding-right:10px; font-family:'DM Mono',monospace; color:var(--sub); font-size:10px; white-space:nowrap; border:none; }
  .hm-hit { background:rgba(0,229,160,.2); color:var(--green); }
  .hm-miss{ background:rgba(255,77,109,.08); color:#3d2030; }

  /* â”€â”€ radar chart â”€â”€ */
  .radar-grid { display:grid; grid-template-columns:1fr 1fr 1fr; gap:20px; }
  canvas.radar { width:100% !important; }

  /* â”€â”€ bar chart â”€â”€ */
  .bar-chart { display:flex; flex-direction:column; gap:8px; }
  .bc-row { display:flex; align-items:center; gap:10px; }
  .bc-label { font-size:12px; font-family:'DM Mono',monospace; color:var(--sub); width:140px; flex-shrink:0; text-align:right; }
  .bc-track { flex:1; height:6px; background:var(--border); border-radius:3px; overflow:hidden; }
  .bc-fill { height:100%; border-radius:3px; transition:width 1s cubic-bezier(.4,0,.2,1); }
  .bc-val { font-size:11px; font-family:'DM Mono',monospace; color:var(--sub); width:42px; }

  /* â”€â”€ role comparison â”€â”€ */
  .role-cmp-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
  .role-cmp-card {
    background:var(--surface); border:1px solid var(--border2);
    border-radius:12px; padding:20px;
  }
  .role-cmp-name { font-family:'Syne',sans-serif; font-weight:700; font-size:14px; margin-bottom:12px; }
  .role-cmp-score { font-size:28px; font-family:'Syne',sans-serif; font-weight:800; }
  .role-cmp-sub { font-size:11px; color:var(--sub); font-family:'DM Mono',monospace; margin-top:4px; }

  /* â”€â”€ gap analysis â”€â”€ */
  .gap-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
  .gap-list { display:flex; flex-direction:column; gap:6px; }
  .gap-item { display:flex; align-items:center; gap:10px; }
  .gap-skill { font-family:'DM Mono',monospace; font-size:12px; flex:1; }
  .gap-freq-track { width:100px; height:4px; background:var(--border); border-radius:2px; overflow:hidden; }
  .gap-freq-fill { height:100%; border-radius:2px; background:var(--red); }
  .gap-freq-val { font-size:11px; color:var(--sub); font-family:'DM Mono',monospace; width:20px; }

  /* â”€â”€ report card â”€â”€ */
  .report-card {
    background:linear-gradient(135deg,#0f1820 0%,#0d1117 50%,#111018 100%);
    border:1px solid var(--border2); border-radius:16px; padding:32px;
    position:relative; overflow:hidden;
  }
  .report-card::before {
    content:''; position:absolute; top:-60px; right:-60px;
    width:200px; height:200px; border-radius:50%;
    background:radial-gradient(circle,rgba(0,229,160,.08) 0%, transparent 70%);
  }
  .rc-grade {
    font-family:'Syne',sans-serif; font-size:72px; font-weight:800;
    line-height:1; margin-bottom:8px;
  }
  .rc-role { font-size:14px; color:var(--sub); margin-bottom:20px; }
  .rc-stat-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
  .rc-stat { display:flex; flex-direction:column; gap:4px; }
  .rc-stat-val { font-family:'DM Mono',monospace; font-size:18px; font-weight:500; }
  .rc-stat-label { font-size:11px; color:var(--sub); }

  /* â”€â”€ section headers â”€â”€ */
  .section-header {
    display:flex; align-items:center; gap:12px; margin-bottom:20px;
  }
  .section-title { font-family:'Syne',sans-serif; font-weight:800; font-size:18px; }
  .section-badge {
    font-family:'DM Mono',monospace; font-size:10px; color:var(--sub);
    border:1px solid var(--border2); padding:3px 9px; border-radius:10px;
  }
  .section-line { flex:1; height:1px; background:var(--border); }

  /* â”€â”€ toast â”€â”€ */
  .toast {
    position:fixed; bottom:30px; right:30px; z-index:100;
    background:var(--card); border:1px solid var(--green);
    color:var(--green); padding:14px 20px; border-radius:10px;
    font-family:'DM Mono',monospace; font-size:13px;
    transform:translateY(80px); opacity:0; transition:all .3s;
    display:flex; align-items:center; gap:10px;
  }
  .toast.show { transform:translateY(0); opacity:1; }

  /* â”€â”€ download btn â”€â”€ */
  .dl-btn {
    display:inline-flex; align-items:center; gap:8px;
    background:var(--surface); border:1px solid var(--border2);
    color:var(--text); padding:10px 18px; border-radius:8px;
    font-family:'DM Mono',monospace; font-size:12px; cursor:pointer;
    transition:all .2s; text-decoration:none;
  }
  .dl-btn:hover { border-color:var(--green); color:var(--green); }

  /* â”€â”€ empty state â”€â”€ */
  .empty { padding:60px; text-align:center; color:var(--sub); }
  .empty-icon { font-size:40px; margin-bottom:12px; opacity:.4; }
  .empty-text { font-size:14px; }

  /* â”€â”€ tabs â”€â”€ */
  .tabs { display:flex; gap:2px; margin-bottom:24px; background:var(--surface); border-radius:10px; padding:4px; width:fit-content; }
  .tab-btn {
    padding:8px 20px; border:none; background:none;
    font-family:'DM Mono',monospace; font-size:12px; color:var(--sub);
    cursor:pointer; border-radius:7px; transition:all .2s; letter-spacing:.03em;
  }
  .tab-btn.active { background:var(--card); color:var(--text); }

  /* responsive */
  @media(max-width:900px) {
    header { padding:20px 20px; }
    .hero { padding:40px 20px 30px; }
    .main { padding:0 20px 60px; }
    .step-row { grid-template-columns:1fr; }
    .role-grid { grid-template-columns:1fr 1fr; }
    .summary-row { grid-template-columns:1fr 1fr; }
    .radar-grid { grid-template-columns:1fr; }
    .role-cmp-grid { grid-template-columns:1fr 1fr; }
    .gap-grid { grid-template-columns:1fr; }
    .factors-grid { grid-template-columns:1fr; }
  }
</style>
</head>
<body>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<header>
  <div class="logo">
    <div class="logo-dot"></div>
    ResumeIQ
  </div>
  <div class="header-badge">ML SCREENING ENGINE v2.0</div>
</header>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="hero" style="max-width:1400px;margin:0 auto;padding-left:48px;padding-right:48px;">
  <div class="hero-tag">AI-Powered Talent Matching</div>
  <h1>Screen resumes.<br><em>Instantly.</em></h1>
  <p class="hero-sub">Upload resumes, select a target role, and get ML-powered ranking with skill gap analysis, match scores, and visual reports â€” all in your browser.</p>
</div>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STEP ROW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="main">
  <div class="step-row">
    <div class="step-card">
      <div class="step-num">STEP 01</div>
      <div class="step-title">Upload Resumes</div>
      <div class="step-desc">Drop .txt or .pdf files. Bulk upload supported â€” screen up to 50 resumes at once.</div>
    </div>
    <div class="step-card">
      <div class="step-num">STEP 02</div>
      <div class="step-title">Select Target Role</div>
      <div class="step-desc">Choose from 6 job roles. Each has a pre-built JD profile with required skills.</div>
    </div>
    <div class="step-card">
      <div class="step-num">STEP 03</div>
      <div class="step-title">Get Instant Report</div>
      <div class="step-desc">5-factor ML scoring: skill match, TF-IDF, category coverage, experience, education.</div>
    </div>
  </div>

  <!-- â”€â”€â”€ INPUT PANELS (side by side) â”€â”€â”€ -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px;">

    <!-- Upload Panel -->
    <div class="panel">
      <div class="panel-header">
        <span class="panel-icon">ğŸ“„</span>
        <span class="panel-title">Upload Resumes</span>
      </div>
      <div class="panel-body">
        <div class="upload-zone" id="dropZone">
          <input type="file" id="fileInput" multiple accept=".txt,.pdf,.doc,.docx"/>
          <span class="upload-icon">â¬†ï¸</span>
          <div class="upload-title">Drop files here or click to browse</div>
          <div class="upload-sub">Supports multiple files â€” paste or type resume text too</div>
          <div class="upload-formats">
            <span class="fmt-badge">.TXT</span>
            <span class="fmt-badge">.PDF</span>
            <span class="fmt-badge">.DOC</span>
          </div>
        </div>
        <div class="file-list" id="fileList"></div>

        <!-- Manual text input -->
        <div style="margin-top:16px;">
          <div style="font-size:11px;color:var(--sub);font-family:'DM Mono',monospace;margin-bottom:6px;">OR PASTE RESUME TEXT</div>
          <textarea id="pasteArea" rows="4" style="width:100%;background:var(--surface);border:1px solid var(--border2);border-radius:8px;padding:12px;color:var(--text);font-family:'DM Mono',monospace;font-size:12px;resize:vertical;outline:none;" placeholder="Paste resume text here and click Add..."></textarea>
          <button onclick="addPastedResume()" style="margin-top:8px;background:var(--surface);border:1px solid var(--border2);color:var(--sub);padding:7px 14px;border-radius:6px;cursor:pointer;font-size:12px;font-family:'DM Mono',monospace;">+ Add Resume</button>
        </div>
      </div>
    </div>

    <!-- Role Panel -->
    <div class="panel">
      <div class="panel-header">
        <span class="panel-icon">ğŸ¯</span>
        <span class="panel-title">Select Target Role</span>
      </div>
      <div class="panel-body">
        <div class="role-grid" id="roleGrid"></div>
        <div style="margin-top:16px;padding:14px;background:var(--surface);border-radius:8px;border:1px solid var(--border);">
          <div style="font-size:11px;font-family:'DM Mono',monospace;color:var(--sub);margin-bottom:6px;">SCORING WEIGHTS</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;font-size:11px;font-family:'DM Mono',monospace;color:var(--sub);">
            <span>ğŸ”µ Skill Match <strong style="color:var(--text)">35%</strong></span>
            <span>ğŸŸ£ TF-IDF Sim <strong style="color:var(--text)">30%</strong></span>
            <span>ğŸŸ¢ Cat. Cover <strong style="color:var(--text)">15%</strong></span>
            <span>ğŸŸ¡ Experience <strong style="color:var(--text)">12%</strong></span>
            <span>ğŸ”´ Education <strong style="color:var(--text)">8%</strong></span>
          </div>
        </div>
        <button class="analyze-btn" id="analyzeBtn" onclick="runAnalysis()" disabled>
          <span class="btn-text">âš¡ Analyze Resumes</span>
          <span class="btn-spinner">âŸ³</span>
        </button>
        <div class="progress-wrap" id="progressWrap">
          <div class="progress-label" id="progressLabel">Initializing...</div>
          <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RESULTS AREA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="results">

    <!-- Summary Row -->
    <div class="section-header" style="margin-top:10px;">
      <span class="section-title">Analysis Results</span>
      <span class="section-badge" id="resultsBadge">0 resumes</span>
      <div class="section-line"></div>
      <a class="dl-btn" id="downloadCsv" href="#" onclick="downloadCSV(event)">â¬‡ Export CSV</a>
    </div>

    <div class="summary-row" id="summaryRow"></div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('rankings',this)">Rankings</button>
      <button class="tab-btn" onclick="switchTab('heatmap',this)">Skill Heatmap</button>
      <button class="tab-btn" onclick="switchTab('gaps',this)">Gap Analysis</button>
      <button class="tab-btn" onclick="switchTab('roles',this)">Role Comparison</button>
      <button class="tab-btn" onclick="switchTab('report',this)">Top Report Card</button>
    </div>

    <!-- Rankings Tab -->
    <div id="tab-rankings">
      <div class="candidates-grid" id="candidatesGrid"></div>
    </div>

    <!-- Heatmap Tab -->
    <div id="tab-heatmap" style="display:none;">
      <div class="panel">
        <div class="panel-header"><span class="panel-icon">ğŸ”¥</span><span class="panel-title">Skill Presence Matrix â€” Top 15 Candidates</span></div>
        <div class="panel-body">
          <div class="heatmap-wrap"><table class="heatmap-table" id="heatmapTable"></table></div>
        </div>
      </div>
    </div>

    <!-- Gap Analysis Tab -->
    <div id="tab-gaps" style="display:none;">
      <div class="panel">
        <div class="panel-header"><span class="panel-icon">ğŸ”</span><span class="panel-title">Skill Gap Analysis</span></div>
        <div class="panel-body">
          <div class="gap-grid">
            <div>
              <div class="section-header"><span class="section-title" style="font-size:14px;">Top Missing Skills</span></div>
              <div class="gap-list" id="gapList"></div>
            </div>
            <div>
              <div class="section-header"><span class="section-title" style="font-size:14px;">JD Required Skills by Category</span></div>
              <div class="bar-chart" id="catChart"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Role Comparison Tab -->
    <div id="tab-roles" style="display:none;">
      <div class="panel">
        <div class="panel-header"><span class="panel-icon">ğŸ”„</span><span class="panel-title">All Roles â€” Your Resumes</span></div>
        <div class="panel-body">
          <div class="role-cmp-grid" id="roleCmpGrid"></div>
        </div>
      </div>
    </div>

    <!-- Report Card Tab -->
    <div id="tab-report" style="display:none;">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
        <div class="report-card" id="reportCard"></div>
        <div class="panel">
          <div class="panel-header"><span class="panel-icon">ğŸ“¡</span><span class="panel-title">Top Candidate â€” Factor Radar</span></div>
          <div class="panel-body">
            <canvas id="radarCanvas" width="400" height="400"></canvas>
          </div>
        </div>
      </div>
    </div>

  </div><!-- /results -->
</div><!-- /main -->

<div class="toast" id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT ENGINE â€” full ML pipeline in browser
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SKILL TAXONOMY (from notebook) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SKILL_TAXONOMY = {
  programming_languages: ["python","java","javascript","typescript","c++","c#","r","scala","go","rust","kotlin","swift","php","ruby","matlab","sql","bash","shell","perl","julia"],
  ml_ai: ["machine learning","deep learning","neural network","nlp","natural language processing","computer vision","reinforcement learning","transfer learning","generative ai","llm","transformers","bert","gpt","xgboost","lightgbm","catboost","random forest","gradient boosting","decision tree","svm","support vector machine","clustering","classification","regression","time series","anomaly detection","recommender system","feature engineering"],
  ml_frameworks: ["tensorflow","pytorch","keras","scikit-learn","sklearn","hugging face","fastai","opencv","nltk","spacy","gensim","mlflow","kubeflow","ray","sagemaker"],
  data_tools: ["pandas","numpy","matplotlib","seaborn","plotly","tableau","power bi","looker","excel","spark","hadoop","kafka","airflow","dbt","databricks","jupyter","dask"],
  databases: ["mysql","postgresql","mongodb","redis","cassandra","elasticsearch","sqlite","oracle","dynamodb","firebase","bigquery","snowflake","redshift"],
  cloud_devops: ["aws","azure","gcp","google cloud","docker","kubernetes","terraform","ansible","helm","jenkins","gitlab","github actions","ci/cd","git","github","prometheus","grafana","linux","unix"],
  web_frameworks: ["django","flask","fastapi","react","angular","vue","node.js","express","spring","graphql","rest api","microservices","html","css"],
  soft_skills: ["communication","leadership","teamwork","problem solving","critical thinking","project management","agile","scrum","collaboration","analytical","attention to detail","time management"],
  statistics: ["statistics","probability","hypothesis testing","a/b testing","bayesian","linear algebra","calculus","data visualization","model evaluation","cross validation"]
};

const ALL_SKILLS = {};
for(const [cat,skills] of Object.entries(SKILL_TAXONOMY)) {
  for(const sk of skills) ALL_SKILLS[sk] = cat;
}

// Sort longest first for greedy matching
const SKILLS_SORTED = Object.keys(ALL_SKILLS).sort((a,b) => b.length - a.length);

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ JOB DESCRIPTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const JD_PROFILES = {
  "Data Scientist": {
    icon:"ğŸ§ ", color:"var(--purple)",
    skills:"python,r,machine learning,deep learning,tensorflow,pytorch,scikit-learn,sql,spark,nlp,natural language processing,statistics,a/b testing,aws,docker,kubernetes,mlflow,bert,pandas,numpy,tableau,airflow,postgresql,mongodb,probability,hypothesis testing,communication,agile,xgboost,gradient boosting,classification,regression,clustering",
    desc:`Data Scientist role requiring strong Python, SQL, machine learning and statistical modeling skills. TensorFlow PyTorch Scikit-learn XGBoost deep learning neural network NLP BERT Hugging Face transformers clustering classification regression time series A/B testing bayesian hypothesis testing probability Pandas NumPy Matplotlib Seaborn Tableau Power BI Spark Kafka AWS Docker Kubernetes MLflow Airflow PostgreSQL MongoDB communication leadership agile scrum teamwork`
  },
  "ML Engineer": {
    icon:"âš™ï¸", color:"var(--cyan)",
    skills:"python,tensorflow,pytorch,scikit-learn,mlflow,kubernetes,docker,spark,aws,gcp,airflow,kubeflow,ci/cd,sql,linux,kafka,nlp,computer vision,deep learning,machine learning,bert,git,jenkins,gitlab",
    desc:`Machine Learning Engineer production ML systems at scale. Python TensorFlow PyTorch Keras MLOps MLflow Kubeflow Airflow Ray AWS GCP Azure Terraform Spark Kafka Docker Kubernetes Helm CI/CD Jenkins GitLab Linux NLP computer vision reinforcement learning deep learning feature engineering communication agile teamwork`
  },
  "Full Stack Dev": {
    icon:"ğŸŒ", color:"var(--blue)",
    skills:"react,node.js,python,typescript,aws,docker,postgresql,mongodb,rest api,graphql,ci/cd,kubernetes,git,agile,javascript,html,css,django,flask,microservices,mysql,redis",
    desc:`Full Stack Developer scalable web applications React Angular Vue JavaScript TypeScript HTML CSS Node.js Django Flask FastAPI Spring Boot MySQL PostgreSQL MongoDB Redis AWS Docker Kubernetes CI/CD Jenkins REST API GraphQL Microservices Git Agile Scrum communication teamwork`
  },
  "DevOps Engineer": {
    icon:"ğŸ”§", color:"var(--green)",
    skills:"aws,gcp,azure,kubernetes,docker,terraform,jenkins,ci/cd,ansible,python,bash,prometheus,grafana,linux,git,helm,gitlab,github actions,monitoring,unix",
    desc:`DevOps Cloud Engineer automate scale infrastructure AWS GCP Azure Kubernetes Helm Docker Terraform Ansible CloudFormation CI/CD Jenkins GitLab GitHub Actions ArgoCD Prometheus Grafana ELK Datadog Python Bash Linux system administration communication agile teamwork`
  },
  "Data Analyst": {
    icon:"ğŸ“Š", color:"var(--yellow)",
    skills:"sql,python,r,tableau,power bi,excel,statistics,a/b testing,pandas,numpy,matplotlib,postgresql,communication,agile,data visualization,hypothesis testing,regression,etl",
    desc:`Data Analyst insights business decisions SQL PostgreSQL MySQL Python Pandas NumPy Matplotlib Seaborn Tableau Power BI Looker Excel statistics regression hypothesis testing A/B testing ETL data visualization communication stakeholder management agile teamwork`
  },
  "Software Engineer": {
    icon:"ğŸ’»", color:"var(--red)",
    skills:"python,java,c++,aws,docker,git,rest api,sql,postgresql,agile,ci/cd,microservices,linux,algorithms,data structures,javascript,mongodb,redis,kubernetes",
    desc:`Software Engineer scalable backend systems Python Java C++ Go strong CS fundamentals algorithms data structures PostgreSQL MongoDB Redis REST API microservices distributed systems AWS Docker Kubernetes Git CI/CD Agile communication teamwork problem solving`
  }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let uploadedResumes = [];   // [{name, text}]
let selectedRole    = null;
let analysisResults = null;
let pasteCount      = 0;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RENDER ROLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderRoles() {
  const grid = document.getElementById('roleGrid');
  grid.innerHTML = '';
  for(const [role, meta] of Object.entries(JD_PROFILES)) {
    const btn = document.createElement('button');
    btn.className = 'role-btn' + (selectedRole===role?' active':'');
    const skillCount = meta.skills.split(',').length;
    btn.innerHTML = `<span class="role-icon">${meta.icon}</span><span class="role-name">${role}</span><span class="role-skills">${skillCount} skills required</span>`;
    btn.onclick = () => { selectedRole = role; renderRoles(); updateAnalyzeBtn(); };
    grid.appendChild(btn);
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ FILE HANDLING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const dropZone  = document.getElementById('dropZone');
const fileInput = document.getElementById('fileInput');

dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('drag'); });
dropZone.addEventListener('dragleave', () => dropZone.classList.remove('drag'));
dropZone.addEventListener('drop', e => {
  e.preventDefault(); dropZone.classList.remove('drag');
  handleFiles([...e.dataTransfer.files]);
});
fileInput.addEventListener('change', () => handleFiles([...fileInput.files]));

async function handleFiles(files) {
  for(const file of files) {
    const text = await readFileText(file);
    if(text.trim()) {
      uploadedResumes.push({ name: file.name, text });
    }
  }
  renderFileList();
  updateAnalyzeBtn();
}

function readFileText(file) {
  return new Promise(resolve => {
    const reader = new FileReader();
    reader.onload = e => resolve(e.target.result);
    if(file.name.endsWith('.pdf')) {
      // For PDFs, read as text (basic extraction)
      reader.readAsText(file, 'utf-8');
    } else {
      reader.readAsText(file, 'utf-8');
    }
  });
}

function addPastedResume() {
  const area = document.getElementById('pasteArea');
  const text = area.value.trim();
  if(!text) return;
  pasteCount++;
  uploadedResumes.push({ name: `Pasted Resume #${pasteCount}`, text });
  area.value = '';
  renderFileList();
  updateAnalyzeBtn();
  showToast(`âœ… Resume #${pasteCount} added`);
}

function removeResume(idx) {
  uploadedResumes.splice(idx,1);
  renderFileList();
  updateAnalyzeBtn();
}

function renderFileList() {
  const list = document.getElementById('fileList');
  list.innerHTML = '';
  uploadedResumes.forEach((r,i) => {
    const div = document.createElement('div');
    div.className = 'file-item';
    div.innerHTML = `<span class="file-icon">ğŸ“„</span><span class="file-name">${r.name}</span><span class="file-size">${(r.text.length/1000).toFixed(1)}k chars</span><button class="file-remove" onclick="removeResume(${i})">âœ•</button>`;
    list.appendChild(div);
  });
}

function updateAnalyzeBtn() {
  const btn = document.getElementById('analyzeBtn');
  btn.disabled = !(uploadedResumes.length > 0 && selectedRole);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ NLP ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function cleanText(text) {
  if(!text) return '';
  text = text.toLowerCase();
  text = text.replace(/https?:\/\/\S+/g, ' ');
  text = text.replace(/[^\w\s\+\#\.\-\/]/g, ' ');
  text = text.replace(/\s+/g, ' ').trim();
  return text;
}

function extractSkills(text) {
  const tl = text.toLowerCase();
  const found = {};
  for(const skill of SKILLS_SORTED) {
    const esc = skill.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const re = new RegExp('\\b' + esc + '\\b');
    if(re.test(tl)) found[skill] = ALL_SKILLS[skill];
  }
  return found;
}

function extractYearsExp(text) {
  const t = text.toLowerCase();
  const patterns = [
    /(\d+)\+?\s*years?\s+of\s+experience/,
    /(\d+)\+?\s*years?\s+experience/,
    /experience\s*[:\-]\s*(\d+)/,
    /(\d+)\s*\-\s*\d+\s*years/
  ];
  for(const pat of patterns) {
    const m = t.match(pat);
    if(m) return Math.min(parseInt(m[1]), 20);
  }
  const count = (t.match(/\b(senior|lead|principal|staff|junior|associate)\b/g)||[]).length;
  return Math.min(count*2, 12);
}

function extractEduScore(text) {
  const t = text.toLowerCase();
  if(/\bph\.?d\b|\bdoctor/.test(t))              return 1.00;
  if(/\bm\.?s\.?\b|\bm\.?tech\b|\bmaster/.test(t)) return 0.85;
  if(/\bmba\b/.test(t))                           return 0.82;
  if(/\bb\.?s\.?\b|\bb\.?e\.?\b|\bbachelor/.test(t)) return 0.70;
  if(/\bassociate\b|\bdiploma\b/.test(t))         return 0.55;
  return 0.50;
}

// TF-IDF cosine similarity (pure JS)
function tfidfCosine(docA, docB) {
  const tokenize = s => s.toLowerCase().split(/\s+/).filter(w => w.length > 2);
  const tA = tokenize(docA), tB = tokenize(docB);
  const vocab = [...new Set([...tA,...tB])];
  const tf = (tokens, term) => tokens.filter(t=>t===term).length / tokens.length;
  const idf = (term) => Math.log((2+1)/(1+[tA,tB].filter(d=>d.includes(term)).length)) + 1;
  const vec = (tokens) => vocab.map(t => tf(tokens,t)*idf(t));
  const vA = vec(tA), vB = vec(tB);
  const dot = vA.reduce((s,a,i)=>s+a*vB[i],0);
  const normA = Math.sqrt(vA.reduce((s,a)=>s+a*a,0));
  const normB = Math.sqrt(vB.reduce((s,b)=>s+b*b,0));
  if(!normA||!normB) return 0;
  return Math.min(dot/(normA*normB), 1);
}

// Score one resume against a JD
function scoreResume(resumeText, jdMeta) {
  const jdText    = jdMeta.desc;
  const jdSkills  = extractSkills(jdText + ' ' + jdMeta.skills);
  const jdCats    = new Set(Object.values(jdSkills));

  const rskills   = extractSkills(resumeText);
  const req       = new Set(Object.keys(jdSkills));
  const cand      = new Set(Object.keys(rskills));

  const matched   = [...req].filter(s => cand.has(s));
  const missing   = [...req].filter(s => !cand.has(s));
  const bonus     = [...cand].filter(s => !req.has(s));

  const skillRate = matched.length / Math.max(req.size, 1);
  const catCov    = [...new Set(matched.map(s=>jdSkills[s]))].length / Math.max(jdCats.size, 1);
  const cos       = tfidfCosine(cleanText(jdText), cleanText(resumeText));
  const yrs       = extractYearsExp(resumeText);
  const expSc     = Math.min(yrs/8, 1);
  const eduSc     = extractEduScore(resumeText);

  const composite = 0.30*cos + 0.35*skillRate + 0.15*catCov + 0.12*expSc + 0.08*eduSc;

  return {
    composite:  Math.round(composite*1000)/10,
    tfidf:      Math.round(cos*1000)/10,
    skillMatch: Math.round(skillRate*1000)/10,
    catCov:     Math.round(catCov*1000)/10,
    expScore:   Math.round(expSc*1000)/10,
    eduScore:   Math.round(eduSc*1000)/10,
    estYears:   yrs,
    matched, missing, bonus,
    totalSkills: cand.size,
    jdSkills,
    snippet: resumeText.slice(0,200).replace(/\n/g,' ').trim()+'...'
  };
}

function statusInfo(score) {
  if(score >= 70) return { label:'Highly Recommended', cls:'rec', color:'var(--green)' };
  if(score >= 50) return { label:'Potential Fit',       cls:'pot', color:'var(--yellow)' };
  return { label:'Not Recommended', cls:'no', color:'var(--red)' };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MAIN ANALYSIS RUNNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runAnalysis() {
  if(!uploadedResumes.length || !selectedRole) return;
  const btn = document.getElementById('analyzeBtn');
  btn.classList.add('loading'); btn.disabled = true;

  const progress = document.getElementById('progressWrap');
  const fill     = document.getElementById('progressFill');
  const label    = document.getElementById('progressLabel');
  progress.classList.add('show');

  const jd = JD_PROFILES[selectedRole];
  const results = [];
  const total = uploadedResumes.length;

  for(let i=0; i<total; i++) {
    label.textContent = `Screening ${uploadedResumes[i].name}... (${i+1}/${total})`;
    fill.style.width  = `${((i+1)/total)*100}%`;
    await sleep(30); // yield to UI
    const sc = scoreResume(uploadedResumes[i].text, jd);
    results.push({ name: uploadedResumes[i].name, text: uploadedResumes[i].text, ...sc });
  }

  results.sort((a,b) => b.composite - a.composite);
  results.forEach((r,i) => r.rank = i+1);

  analysisResults = { results, role: selectedRole, jd };

  label.textContent = 'Rendering results...';
  await sleep(100);
  renderResults(analysisResults);

  btn.classList.remove('loading');
  btn.disabled = false;
  progress.classList.remove('show');
  showToast(`âœ… ${total} resume${total>1?'s':''} screened for ${selectedRole}`);
}

function sleep(ms) { return new Promise(r=>setTimeout(r,ms)); }

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RENDER RESULTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderResults(data) {
  document.getElementById('results').style.display = 'block';
  document.getElementById('resultsBadge').textContent = `${data.results.length} resumes Â· ${data.role}`;
  renderSummary(data);
  renderRankings(data);
  renderHeatmap(data);
  renderGaps(data);
  renderRoleComparison(data);
  renderReportCard(data);
  document.getElementById('results').scrollIntoView({behavior:'smooth',block:'start'});
}

// â”€â”€ SUMMARY â”€â”€
function renderSummary(data) {
  const res = data.results;
  const rec = res.filter(r=>r.composite>=70).length;
  const pot = res.filter(r=>r.composite>=50&&r.composite<70).length;
  const no  = res.filter(r=>r.composite<50).length;
  const top = res[0]?.composite ?? 0;

  document.getElementById('summaryRow').innerHTML = `
    <div class="summary-card"><div class="sc-val" style="color:var(--text)">${res.length}</div><div class="sc-label">TOTAL SCREENED</div></div>
    <div class="summary-card"><div class="sc-val" style="color:var(--green)">${rec}</div><div class="sc-label">RECOMMENDED â‰¥70%</div></div>
    <div class="summary-card"><div class="sc-val" style="color:var(--yellow)">${pot}</div><div class="sc-label">POTENTIAL FIT 50â€“69%</div></div>
    <div class="summary-card"><div class="sc-val" style="color:var(--purple)">${top}%</div><div class="sc-label">TOP SCORE</div></div>
  `;
}

// â”€â”€ RANKINGS â”€â”€
function renderRankings(data) {
  const grid = document.getElementById('candidatesGrid');
  grid.innerHTML = '';
  data.results.forEach((r,i) => {
    const st = statusInfo(r.composite);
    const rankClass = i===0?'gold':i===1?'silver':i===2?'bronze':'';
    const scoreColor = r.composite>=70?'var(--green)':r.composite>=50?'var(--yellow)':'var(--red)';

    const card = document.createElement('div');
    card.className = 'cand-card';
    card.innerHTML = `
      <div class="cand-rank ${rankClass}">#${r.rank}</div>
      <div class="cand-info">
        <div class="cand-cat">${r.name}</div>
        <div class="cand-meta">Est. ${r.estYears} yrs exp Â· ${r.totalSkills} skills Â· ${r.matched.length}/${Object.keys(r.jdSkills).length} JD skills matched</div>
        <div class="score-bar-wrap">
          <div style="display:flex;justify-content:space-between;font-size:11px;font-family:'DM Mono',monospace;color:var(--sub);margin-bottom:4px;">
            <span>Composite Score</span><span style="color:${scoreColor};font-weight:600">${r.composite}%</span>
          </div>
          <div class="score-bar-track"><div class="score-bar-fill" data-width="${r.composite}" style="background:${scoreColor};width:0%"></div></div>
        </div>
        <div class="factors-grid">
          ${[['Skill Match',r.skillMatch,'var(--green)'],['TF-IDF Sim',r.tfidf,'var(--purple)'],['Cat. Coverage',r.catCov,'var(--cyan)'],['Experience',r.expScore,'var(--yellow)'],['Education',r.eduScore,'var(--blue)']].map(([n,v,c])=>`
          <div class="factor-row">
            <div class="factor-label"><span>${n}</span><span style="color:${c}">${v}%</span></div>
            <div class="factor-track"><div class="factor-fill" style="background:${c};width:${v}%"></div></div>
          </div>`).join('')}
        </div>
        <div class="skills-section">
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin-top:6px;">
            <div><div class="skills-label">âœ… MATCHED (${r.matched.length})</div><div class="skills-chips">${r.matched.slice(0,15).map(s=>`<span class="chip matched">${s}</span>`).join('')}</div></div>
            <div><div class="skills-label">âŒ MISSING (${r.missing.length})</div><div class="skills-chips">${r.missing.slice(0,15).map(s=>`<span class="chip missing">${s}</span>`).join('')}</div></div>
            <div><div class="skills-label">â­ BONUS (${r.bonus.length})</div><div class="skills-chips">${r.bonus.slice(0,10).map(s=>`<span class="chip bonus">${s}</span>`).join('')}</div></div>
          </div>
          <div style="margin-top:12px;font-size:12px;color:var(--sub);font-family:'DM Mono',monospace;line-height:1.5;">${r.snippet}</div>
        </div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px;">
        <span class="score-badge ${st.cls}">${st.label}</span>
      </div>
    `;
    card.onclick = () => { card.classList.toggle('expanded'); };
    grid.appendChild(card);
  });

  // Animate bars
  requestAnimationFrame(() => {
    document.querySelectorAll('.score-bar-fill[data-width]').forEach(el => {
      el.style.width = el.dataset.width + '%';
    });
  });
}

// â”€â”€ HEATMAP â”€â”€
function renderHeatmap(data) {
  const top15 = data.results.slice(0,15);
  const jdSkillList = [...new Set(data.results.flatMap(r=>r.matched.concat(r.missing)))].sort().slice(0,30);

  const tbl = document.getElementById('heatmapTable');
  let html = '<thead><tr><th class="row-head">Candidate / Skill â†’</th>';
  for(const sk of jdSkillList) html += `<th>${sk}</th>`;
  html += '</tr></thead><tbody>';

  for(const r of top15) {
    const matchSet = new Set(r.matched);
    html += `<tr><td class="row-label">#${r.rank} ${r.name.slice(0,20)}</td>`;
    for(const sk of jdSkillList) {
      html += matchSet.has(sk) ? `<td class="hm-hit">âœ“</td>` : `<td class="hm-miss">âœ—</td>`;
    }
    html += '</tr>';
  }
  tbl.innerHTML = html + '</tbody>';
}

// â”€â”€ GAP ANALYSIS â”€â”€
function renderGaps(data) {
  const top20 = data.results.slice(0,20);
  const freq = {};
  for(const r of top20) for(const sk of r.missing) freq[sk] = (freq[sk]||0)+1;
  const sorted = Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,15);
  const maxF = sorted[0]?.[1]||1;

  const gapList = document.getElementById('gapList');
  gapList.innerHTML = sorted.map(([sk,f])=>`
    <div class="gap-item">
      <span class="gap-skill">${sk}</span>
      <div class="gap-freq-track"><div class="gap-freq-fill" style="width:${(f/maxF)*100}%"></div></div>
      <span class="gap-freq-val">${f}</span>
    </div>
  `).join('');

  // JD skill categories
  const catCount = {};
  for(const sk of Object.keys(data.jd.jdSkills||extractSkills(data.jd.desc+' '+data.jd.skills))) {
    const cat = ALL_SKILLS[sk]||'other';
    catCount[cat] = (catCount[cat]||0)+1;
  }
  const jdSk = extractSkills(data.jd.desc+' '+data.jd.skills);
  const cc = {};
  for(const sk of Object.keys(jdSk)) { const c=ALL_SKILLS[sk]||'other'; cc[c]=(cc[c]||0)+1; }
  const catSorted = Object.entries(cc).sort((a,b)=>b[1]-a[1]);
  const maxC = catSorted[0]?.[1]||1;

  const catColors = ['var(--purple)','var(--cyan)','var(--green)','var(--yellow)','var(--red)','var(--blue)','var(--purple)','var(--green)','var(--sub)'];
  document.getElementById('catChart').innerHTML = catSorted.map(([cat,cnt],i)=>`
    <div class="bc-row">
      <span class="bc-label">${cat}</span>
      <div class="bc-track"><div class="bc-fill" style="background:${catColors[i%catColors.length]};width:${(cnt/maxC)*100}%"></div></div>
      <span class="bc-val">${cnt}</span>
    </div>
  `).join('');

  // Store jdSkills on data for heatmap
  data.jd.jdSkills = jdSk;
}

// â”€â”€ ROLE COMPARISON (run best resume against all roles) â”€â”€
async function renderRoleComparison(data) {
  if(!data.results.length) return;
  const topText = data.results[0].text;
  const grid = document.getElementById('roleCmpGrid');
  grid.innerHTML = '';
  const rows = [];
  for(const [role, meta] of Object.entries(JD_PROFILES)) {
    const sc = scoreResume(topText, meta);
    rows.push({ role, meta, sc });
  }
  rows.sort((a,b) => b.sc.composite - a.sc.composite);
  const max = rows[0].sc.composite||1;

  for(const {role,meta,sc} of rows) {
    const st = statusInfo(sc.composite);
    const div = document.createElement('div');
    div.className = 'role-cmp-card';
    div.innerHTML = `
      <div class="role-cmp-name">${meta.icon} ${role}</div>
      <div class="role-cmp-score" style="color:${meta.color}">${sc.composite}%</div>
      <div class="role-cmp-sub">${sc.matched.length} / ${sc.matched.length+sc.missing.length} skills matched</div>
      <div style="margin-top:10px;height:4px;background:var(--border);border-radius:2px;overflow:hidden;">
        <div style="height:100%;width:${sc.composite}%;background:${meta.color};border-radius:2px;"></div>
      </div>
      <div style="margin-top:8px;"><span class="score-badge ${st.cls}" style="font-size:10px;">${st.label}</span></div>
    `;
    grid.appendChild(div);
  }
}

// â”€â”€ REPORT CARD + RADAR â”€â”€
function renderReportCard(data) {
  const r = data.results[0];
  if(!r) return;
  const score = r.composite;
  const grade = score>=90?'A+':score>=80?'A':score>=75?'B+':score>=70?'B':score>=65?'C+':score>=55?'C':score>=50?'D':'F';
  const gc    = score>=70?'var(--green)':score>=50?'var(--yellow)':'var(--red)';

  const eduLabel = r.eduScore>=87?'Ph.D.':r.eduScore>=83?'M.S./M.Tech.':r.eduScore>=80?'MBA':r.eduScore>=68?'B.S./B.E.':r.eduScore>=53?'Diploma':'Unknown';

  document.getElementById('reportCard').innerHTML = `
    <div style="position:relative;z-index:1;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--sub);letter-spacing:.15em;margin-bottom:12px;">TOP CANDIDATE REPORT</div>
      <div class="rc-grade" style="color:${gc}">${grade}</div>
      <div class="rc-role" style="margin-bottom:4px;">${r.name}</div>
      <div style="font-size:12px;color:var(--sub);margin-bottom:24px;font-family:'DM Mono',monospace;">Target Role: ${data.role}</div>
      <div class="rc-stat-grid">
        <div class="rc-stat"><span class="rc-stat-val" style="color:${gc}">${score}%</span><span class="rc-stat-label">Composite Score</span></div>
        <div class="rc-stat"><span class="rc-stat-val" style="color:var(--green)">${r.skillMatch}%</span><span class="rc-stat-label">Skill Match</span></div>
        <div class="rc-stat"><span class="rc-stat-val" style="color:var(--cyan)">${r.tfidf}%</span><span class="rc-stat-label">TF-IDF Similarity</span></div>
        <div class="rc-stat"><span class="rc-stat-val" style="color:var(--purple)">${r.catCov}%</span><span class="rc-stat-label">Category Coverage</span></div>
        <div class="rc-stat"><span class="rc-stat-val" style="color:var(--yellow)">${r.estYears} yr</span><span class="rc-stat-label">Est. Experience</span></div>
        <div class="rc-stat"><span class="rc-stat-val" style="color:var(--blue)">${eduLabel}</span><span class="rc-stat-label">Education</span></div>
      </div>
      <div style="margin-top:20px;padding-top:16px;border-top:1px solid var(--border2);">
        <div style="font-size:11px;font-family:'DM Mono',monospace;color:var(--sub);margin-bottom:8px;">TOP MISSING SKILLS TO IMPROVE</div>
        <div class="skills-chips">${r.missing.slice(0,8).map(s=>`<span class="chip missing">${s}</span>`).join('')||'<span style="color:var(--green);font-size:12px;">Perfect match! âœ…</span>'}</div>
      </div>
    </div>
  `;

  drawRadar(r);
}

// â”€â”€ RADAR CANVAS â”€â”€
function drawRadar(r) {
  const canvas = document.getElementById('radarCanvas');
  const ctx    = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0,0,W,H);

  const cx = W/2, cy = H/2, radius = Math.min(W,H)/2 - 40;
  const labels = ['Skill\nMatch','TF-IDF','Cat.\nCovr','Experience','Education'];
  const values = [r.skillMatch,r.tfidf,r.catCov,r.expScore,r.eduScore];
  const N = labels.length;
  const angleStep = (2*Math.PI)/N;
  const startAngle = -Math.PI/2;

  // grid rings
  ctx.font = '11px DM Mono';
  for(let ring=1; ring<=4; ring++) {
    const r2 = (ring/4)*radius;
    ctx.beginPath();
    for(let i=0;i<N;i++) {
      const a = startAngle + i*angleStep;
      const x = cx + r2*Math.cos(a), y = cy + r2*Math.sin(a);
      i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);
    }
    ctx.closePath();
    ctx.strokeStyle = '#1e2130'; ctx.lineWidth=1; ctx.stroke();
    ctx.fillStyle='#6b7394'; ctx.textAlign='center';
    ctx.fillText(`${ring*25}`, cx+4, cy-(r2)-4);
  }

  // axes
  for(let i=0;i<N;i++) {
    const a = startAngle + i*angleStep;
    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.lineTo(cx+radius*Math.cos(a), cy+radius*Math.sin(a));
    ctx.strokeStyle='#252840'; ctx.lineWidth=1; ctx.stroke();
  }

  // data polygon
  ctx.beginPath();
  for(let i=0;i<N;i++) {
    const a = startAngle + i*angleStep;
    const rv = (values[i]/100)*radius;
    const x = cx+rv*Math.cos(a), y = cy+rv*Math.sin(a);
    i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);
  }
  ctx.closePath();
  const grad = ctx.createRadialGradient(cx,cy,0,cx,cy,radius);
  grad.addColorStop(0,'rgba(0,229,160,0.4)');
  grad.addColorStop(1,'rgba(0,229,160,0.05)');
  ctx.fillStyle=grad; ctx.fill();
  ctx.strokeStyle='#00e5a0'; ctx.lineWidth=2.5; ctx.stroke();

  // dots
  for(let i=0;i<N;i++) {
    const a = startAngle + i*angleStep;
    const rv = (values[i]/100)*radius;
    ctx.beginPath();
    ctx.arc(cx+rv*Math.cos(a), cy+rv*Math.sin(a), 4, 0, 2*Math.PI);
    ctx.fillStyle='#00e5a0'; ctx.fill();
  }

  // labels
  ctx.fillStyle='#6b7394'; ctx.font='11px DM Mono'; ctx.textAlign='center';
  for(let i=0;i<N;i++) {
    const a = startAngle + i*angleStep;
    const lx = cx+(radius+26)*Math.cos(a), ly = cy+(radius+26)*Math.sin(a);
    const lines = labels[i].split('\n');
    lines.forEach((ln,li) => ctx.fillText(ln, lx, ly + li*14));
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchTab(tab, btn) {
  ['rankings','heatmap','gaps','roles','report'].forEach(t => {
    const el = document.getElementById('tab-'+t);
    if(el) el.style.display = t===tab?'block':'none';
  });
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  if(tab==='report' && analysisResults) drawRadar(analysisResults.results[0]);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EXPORT CSV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function downloadCSV(e) {
  e.preventDefault();
  if(!analysisResults) return;
  const rows = [['Rank','Name','Composite Score','Status','Skill Match %','TF-IDF %','Cat Coverage %','Exp Score %','Edu Score %','Est Years Exp','Matched Skills','Missing Skills','Bonus Skills']];
  for(const r of analysisResults.results) {
    const st = statusInfo(r.composite);
    rows.push([r.rank,r.name,r.composite,st.label,r.skillMatch,r.tfidf,r.catCov,r.expScore,r.eduScore,r.estYears,r.matched.join(';'),r.missing.join(';'),r.bonus.join(';')]);
  }
  const csv = rows.map(r=>r.map(v=>`"${v}"`).join(',')).join('\n');
  const a = document.createElement('a');
  a.href = 'data:text/csv;charset=utf-8,'+encodeURIComponent(csv);
  a.download = `${analysisResults.role.replace(' ','_')}_screening_results.csv`;
  a.click();
  showToast('â¬‡ CSV downloaded');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 3000);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderRoles();

// Add demo resumes for easy testing
function addDemoResumes() {
  const demos = [
    { name: 'Alice_DataScientist.txt', text: `Alice Johnson | alice@email.com
SUMMARY: Data Scientist with 5 years experience in machine learning, Python, NLP, deep learning and statistical modeling.
EXPERIENCE: Senior Data Scientist â€” Google (5 years)
â€¢ Machine learning models: TensorFlow, PyTorch, Scikit-learn, XGBoost, gradient boosting
â€¢ NLP pipelines: BERT, Hugging Face transformers, spaCy, NLTK, deep learning
â€¢ Statistical analysis: regression, classification, clustering, A/B testing, hypothesis testing
â€¢ Data tools: Pandas, NumPy, Matplotlib, Seaborn, Tableau, Power BI, Jupyter
â€¢ Cloud & MLOps: AWS, Docker, Kubernetes, MLflow, Airflow, Spark, Kafka
â€¢ Databases: PostgreSQL, MongoDB, Spark; statistics, probability
SKILLS: Python, R, SQL, TensorFlow, PyTorch, Scikit-learn, XGBoost, Pandas, NumPy,
Tableau, AWS, Docker, Kubernetes, MLflow, BERT, NLP, Machine Learning, Deep Learning,
Regression, Classification, A/B Testing, PostgreSQL, MongoDB, Linux, Git, Agile, Scrum
EDUCATION: M.S. Computer Science | Stanford University` },
    { name: 'Bob_MLEngineer.txt', text: `Bob Martinez | bob@email.com
ML ENGINEER â€” 4 YEARS EXPERIENCE
EXPERIENCE: ML Engineer â€” Amazon (4 years)
â€¢ Production ML: PyTorch, TensorFlow, Keras, XGBoost, LightGBM, Scikit-learn
â€¢ MLOps: MLflow, Kubeflow, Airflow, Ray; deep learning CNNs RNNs Transformers
â€¢ NLP, computer vision, reinforcement learning; Hugging Face, BERT, GPT
â€¢ Distributed: Spark, Kafka on AWS, GCP, Azure; Docker, Kubernetes, CI/CD
â€¢ Jenkins, GitLab; Linux system administration; Python, Scala
SKILLS: Python, Scala, SQL, TensorFlow, PyTorch, Scikit-learn, XGBoost,
Hugging Face, MLflow, Kubeflow, Airflow, AWS, GCP, Azure, Docker, Kubernetes,
Terraform, Spark, Kafka, PostgreSQL, MongoDB, Machine Learning, Deep Learning,
NLP, Computer Vision, Git, Linux, CI/CD, Agile
EDUCATION: M.Tech. Computer Science` },
    { name: 'Carol_Accountant.txt', text: `Carol White | carol@email.com
Certified Accountant (CPA) â€” 6 years
EXPERIENCE: Senior Accountant â€” Deloitte (6 years)
â€¢ Financial statements: P&L, Balance Sheet, Cash Flow â€” GAAP/IFRS
â€¢ Tax compliance, auditing, accounts payable and receivable
â€¢ QuickBooks, SAP, Oracle Financials, NetSuite, Excel, Power BI
â€¢ Month-end/year-end close processes
SKILLS: Financial Reporting, GAAP, IFRS, Tax Compliance, Auditing, Excel, SAP, QuickBooks
EDUCATION: B.S. Accounting` },
    { name: 'David_FullStack.txt', text: `David Kim | david@email.com
Full Stack Developer â€” 3 years
EXPERIENCE: Senior Developer â€” Netflix (3 years)
â€¢ React, Angular, Vue.js frontend with TypeScript and JavaScript
â€¢ Backend: Node.js, Django, Flask, FastAPI, REST API, GraphQL
â€¢ Databases: MySQL, PostgreSQL, MongoDB, Redis, Firebase
â€¢ Docker, Kubernetes on AWS; CI/CD Jenkins, GitLab
â€¢ HTML5, CSS3, SASS, Microservices, Agile/Scrum
SKILLS: React, Angular, Vue, JavaScript, TypeScript, HTML, CSS, Node.js, Django,
Flask, FastAPI, MySQL, PostgreSQL, MongoDB, Redis, AWS, Docker, Kubernetes,
Jenkins, CI/CD, Git, GraphQL, REST API, Microservices, Agile, Scrum
EDUCATION: B.S. Computer Science` }
  ];
  uploadedResumes = [...uploadedResumes, ...demos];
  renderFileList();
  updateAnalyzeBtn();
  showToast('âœ… 4 demo resumes loaded');
}
</script>

<!-- â”€â”€ Demo button in corner â”€â”€ -->
<div style="position:fixed;bottom:30px;left:30px;z-index:50;">
  <button onclick="addDemoResumes()" style="background:var(--card);border:1px solid var(--border2);color:var(--sub);padding:10px 18px;border-radius:8px;cursor:pointer;font-family:'DM Mono',monospace;font-size:12px;transition:all .2s;" onmouseover="this.style.borderColor='var(--cyan)';this.style.color='var(--cyan)'" onmouseout="this.style.borderColor='var(--border2)';this.style.color='var(--sub)'">
    ğŸ§ª Load Demo Resumes
  </button>
</div>

</body>
</html>
